<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<link rel="icon" type="image/svg+xml" href="%sveltekit.assets%/images/logo.svg" />
		<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
		<script>
			(() => {
				try {
					const root = document.documentElement;
					const storedTheme = localStorage.getItem('theme');
					if (storedTheme === 'dark') {
						root.classList.add('dark');
					} else if (storedTheme === 'light') {
						root.classList.remove('dark');
					} else if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
						root.classList.add('dark');
					}

					const stored = localStorage.getItem('sideBar.layout');
					if (!stored) return;
					const parsed = JSON.parse(stored);
					const ratio =
						typeof parsed.sidebarRatio === 'number'
							? parsed.sidebarRatio
							: typeof parsed.chatPanelRatio === 'number'
								? parsed.chatPanelRatio
								: typeof parsed.chatSidebarRatio === 'number'
									? parsed.chatSidebarRatio
									: typeof parsed.workspaceSidebarRatio === 'number'
										? parsed.workspaceSidebarRatio
										: null;
					if (typeof ratio === 'number') {
						const clamped = Math.min(Math.max(ratio, 0.2), 0.5);
						document.documentElement.style.setProperty(
							'--sidebar-width',
							`${(clamped * 100).toFixed(2)}%`
						);
					}

					const setAppHeight = () => {
						const height =
							window.visualViewport?.height ?? window.innerHeight ?? document.documentElement.clientHeight;
						document.documentElement.style.setProperty('--app-height', `${Math.round(height)}px`);
					};
					setAppHeight();
					window.addEventListener('resize', setAppHeight);
					window.visualViewport?.addEventListener('resize', setAppHeight);
				} catch {
					// Ignore storage errors.
				}
			})();
		</script>
		%sveltekit.head%
	</head>
	<body data-sveltekit-preload-data="hover">
		<div id="svelte">%sveltekit.body%</div>
	</body>
</html>
